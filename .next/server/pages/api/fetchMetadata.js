"use strict";(()=>{var t={};t.id=727,t.ids=[727],t.modules={145:t=>{t.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5582:t=>{t.exports=import("viem")},6249:(t,e)=>{Object.defineProperty(e,"l",{enumerable:!0,get:function(){return function t(e,a){return a in e?e[a]:"then"in e&&"function"==typeof e.then?e.then(e=>t(e,a)):"function"==typeof e&&"default"===a?e:void 0}}})},1462:(t,e,a)=>{a.a(t,async(t,n)=>{try{a.r(e),a.d(e,{config:()=>p,default:()=>c,routeModule:()=>l});var r=a(1802),i=a(7153),s=a(6249),o=a(1461),u=t([o]);o=(u.then?(await u)():u)[0];let c=(0,s.l)(o,"default"),p=(0,s.l)(o,"config"),l=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/fetchMetadata",pathname:"/api/fetchMetadata",bundlePath:"",filename:""},userland:o});n()}catch(t){n(t)}})},1461:(t,e,a)=>{a.a(t,async(t,n)=>{try{a.r(e),a.d(e,{default:()=>u});var r=a(5582),i=a(812),s=a(753),o=t([r,i]);async function u(t,e){if("POST"!==t.method)return e.status(405).json({error:"POST only"});try{let{contract:a,tokenId:n}=t.body;if(!a||!n)return e.status(400).json({error:"Missing inputs"});let o=(0,r.createPublicClient)({chain:i.o,transport:(0,r.http)()}),u=await o.readContract({address:a,abi:s.u,functionName:"tokenURI",args:[BigInt(n)]});u=c(u);let p=await fetch(u);if(!p.ok)throw Error(`Metadata fetch failed (${p.status})`);let l=await p.json(),d=l.image||l.image_url;return d&&(d=c(d)),e.status(200).json({tokenURI:u,metadata:l,image:d})}catch(t){return e.status(500).json({error:t.message})}}function c(t){if(!t)return null;if(t.startsWith("ipfs://")){let e=t.replace("ipfs://","");return`https://ipfs.io/ipfs/${e}`}return/^[a-z0-9]{46,}$/i.test(t)?`https://ipfs.io/ipfs/${t}`:t}[r,i]=o.then?(await o)():o,n()}catch(t){n(t)}})},753:(t,e,a)=>{a.d(e,{u:()=>n});let n=[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{type:"string"}]},{name:"ownerOf",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{type:"address"}]}]},812:(t,e,a)=>{a.a(t,async(t,n)=>{try{a.d(e,{o:()=>s});var r=a(5582),i=t([r]);r=(i.then?(await i)():i)[0];let s=(0,r.defineChain)({id:Number("33139"),name:"ApeChain",nativeCurrency:{name:"ApeCoin",symbol:"APE",decimals:18},rpcUrls:{default:{http:[process.env.RPC_URL||"https://apechain.calderachain.xyz/http"]},public:{http:[process.env.RPC_URL||"https://apechain.calderachain.xyz/http"]}},blockExplorers:{default:{name:"ApeScan",url:"https://apechain.calderaexplorer.xyz"}},contracts:{multicall3:{address:"0xcA11bde05977b3631167028862bE2a173976CA11",blockCreated:1}}});n()}catch(t){n(t)}})},7153:(t,e)=>{var a;Object.defineProperty(e,"x",{enumerable:!0,get:function(){return a}}),function(t){t.PAGES="PAGES",t.PAGES_API="PAGES_API",t.APP_PAGE="APP_PAGE",t.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(t,e,a)=>{t.exports=a(145)}};var e=require("../../webpack-api-runtime.js");e.C(t);var a=e(e.s=1462);module.exports=a})();